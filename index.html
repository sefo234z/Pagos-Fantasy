<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resumen de Pagos - Por Persona</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>üèÜ Resumen de Pagos Totales por Persona</h1>
        <nav>
            <button class="active">Resumen por Persona</button>
            <a href="jornadas.html"><button>Pagos por Jornada</button></a>
        </nav>
    </header>

    <main>
        <div id="bote-total-container">
            <h2>üí∞ Bote Total Acumulado</h2>
            <p id="bote-cantidad">Calculando...</p>
        </div>
        
        <section id="home-view" class="content-section">
            <h2>Clasificaci√≥n de Pagos (Descendente)</h2>
            <table id="tabla-resumen">
                <thead>
                    <tr>
                        <th>Persona</th>
                        <th>Total Pagado (‚Ç¨)</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </section>
    </main>

    <script>
        // DATOS CSV INCRUSTADOS
        const csvData = `
Tipo,Concepto,Persona,Cantidad (‚Ç¨)
Semana,1,MANZANO,1
Semana,1,GUERRERO,2
Semana,1,FOLO,3.50
Semana,1,IKER,3.50
Semana,2,FOLO,1
Semana,2,MOSCA,2
Semana,2,MARCOSGUAJE,3
Semana,2,MANZANO,4
`;

        // Funci√≥n para parsear el CSV
        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',');
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                const entry = {};
                for (let j = 0; j < headers.length; j++) {
                    entry[headers[j].trim()] = values[j].trim();
                }
                data.push(entry);
            }
            return data;
        }

        const datos = parseCSV(csvData);

        // --- NUEVA FUNCI√ìN: CALCULAR Y MOSTRAR EL BOTE TOTAL ---
        function renderBoteTotal(datos) {
            let total = 0;
            datos.forEach(item => {
                // Sumar todas las cantidades
                total += parseFloat(item['Cantidad (‚Ç¨)']) || 0;
            });

            const boteElement = document.getElementById('bote-cantidad');
            // Mostrar el total con formato de dos decimales y el s√≠mbolo ‚Ç¨
            boteElement.textContent = `${total.toFixed(2)} ‚Ç¨`;
            boteElement.style.fontSize = '2em'; // Opcional: para que destaque
            boteElement.style.fontWeight = 'bold';
            boteElement.style.color = '#28a745'; // Color verde para destacar
        }


        // L√≥gica para la vista de Resumen por Persona
        function renderResumenPorPersona() {
            const tbody = document.querySelector('#tabla-resumen tbody');
            tbody.innerHTML = ''; 

            const totales = {};
            datos.forEach(item => {
                const persona = item['Persona'];
                const cantidad = parseFloat(item['Cantidad (‚Ç¨)']) || 0; 
                
                if (totales[persona]) {
                    totales[persona] += cantidad;
                } else {
                    totales[persona] = cantidad;
                }
            });

            const resumenArray = Object.keys(totales).map(persona => ({
                persona: persona,
                total: totales[persona]
            }));

            // Ordenar de forma DESCENDENTE
            resumenArray.sort((a, b) => b.total - a.total);

            resumenArray.forEach(item => {
                const row = tbody.insertRow();
                const cellPersona = row.insertCell();
                const cellTotal = row.insertCell();

                cellPersona.textContent = item.persona;
                cellPersona.setAttribute('data-label', 'PERSONA'); 
                
                cellTotal.textContent = item.total.toFixed(2);
                cellTotal.setAttribute('data-label', 'TOTAL PAGADO'); 
                cellTotal.classList.add('amount'); 
            });
        }

        // Inicializar al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            renderBoteTotal(datos); // <-- LLAMADA PARA MOSTRAR EL BOTE
            renderResumenPorPersona(); 
        });
    </script>
</body>
</html>






